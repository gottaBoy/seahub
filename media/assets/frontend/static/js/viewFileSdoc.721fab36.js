"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[539],{53854:function(e,r,n){var t=n(72791),i=n(54164),a=n(39230),o=n(50906),s=n(95996),c=n(63446),u=n(15671),l=n(43144),d=n(60136),h=n(29388),g=n(32775),S=n(22228),p=n(51832),f=n(22386),m=n(65953),D=n(80184),I=function(e){(0,d.Z)(n,e);var r=(0,h.Z)(n);function n(e){var t;return(0,u.Z)(this,n),(t=r.call(this,e)).onInternalLinkToggle=function(){t.setState({isShowInternalLinkDialog:!t.state.isShowInternalLinkDialog})},t.unmark=function(){var e=t.props,r=e.repoID,n=e.docPath;S.I.sdocUnmarkAsDraft(r,n).then((function(e){t.props.unmarkDraft()})).catch((function(e){var r=s.c.getErrorMsg(e);p.Z.danger(r)}))},t.toggleStar=function(){var e=t.props,r=e.isStarred,n=e.repoID,i=e.docPath;r?S.I.unstarItem(n,i).then((function(e){t.props.toggleStar(!1)})).catch((function(e){var r=s.c.getErrorMsg(e);p.Z.danger(r)})):S.I.starItem(n,i).then((function(e){t.props.toggleStar(!0)})).catch((function(e){var r=s.c.getErrorMsg(e);p.Z.danger(r)}))},t.onShareToggle=function(){t.setState({isShowShareDialog:!t.state.isShowShareDialog})},t.state={isShowInternalLinkDialog:!1,isShowShareDialog:!1},t}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){var e=g.Nd.getInstance();this.unsubscribeInternalLinkEvent=e.subscribe(g.dK.INTERNAL_LINK_CLICK,this.onInternalLinkToggle),this.unsubscribeStar=e.subscribe(g.dK.TOGGLE_STAR,this.toggleStar),this.unsubscribeUnmark=e.subscribe(g.dK.UNMARK_AS_DRAFT,this.unmark),this.unsubscribeShare=e.subscribe(g.dK.SHARE_SDOC,this.onShareToggle)}},{key:"componentWillUnmount",value:function(){this.unsubscribeInternalLinkEvent(),this.unsubscribeStar(),this.unsubscribeUnmark(),this.unsubscribeShare()}},{key:"render",value:function(){var e=this.props,r=e.repoID,n=e.docPath,t=e.docName,i=e.docPerm,a=this.state,o=a.isShowInternalLinkDialog,s=a.isShowShareDialog;return(0,D.jsxs)(D.Fragment,{children:[o&&(0,D.jsx)(f.Z,{repoID:r,path:n,onInternalLinkDialogToggle:this.onInternalLinkToggle}),s&&(0,D.jsx)(m.Z,{itemType:"file",itemPath:n,itemName:t,repoID:r,userPerm:i,toggleDialog:this.onShareToggle})]})}}]),n}(t.Component),v=I,b=function(e){(0,d.Z)(n,e);var r=(0,h.Z)(n);function n(e){var t;(0,u.Z)(this,n),(t=r.call(this,e)).toggleStar=function(e){t.setState({isStarred:e})},t.unmarkDraft=function(){t.setState({isDraft:!1})};var i=window.app.pageOptions,a=i.isStarred,o=i.isSdocDraft;return t.state={isStarred:a,isDraft:o},t}return(0,l.Z)(n,[{key:"render",value:function(){var e=window.seafile,r=e.repoID,n=e.docPath,i=e.docName,a=e.docPerm,o=this.state,s=o.isStarred,c=o.isDraft;return(0,D.jsxs)(t.Fragment,{children:[(0,D.jsx)(g.Qo,{isStarred:s,isDraft:c}),(0,D.jsx)(v,{repoID:r,docPath:n,docName:i,docPerm:a,isStarred:s,toggleStar:this.toggleStar,unmarkDraft:this.unmarkDraft})]})}}]),n}(t.Component),k=window.app.config,w=k.serviceURL,L=k.avatarURL,U=k.siteRoot,P=k.lang,R=k.mediaUrl,Z=window.app.userInfo,T=Z.username,N=Z.name,j=window.app.pageOptions,x=j.repoID,A=j.repoName,F=j.parentDir,y=j.filePerm,C=j.docPath,E=j.docName,_=j.docUuid,K=j.seadocAccessToken,O=j.seadocServerUrl,M=j.assetsUrl,G=j.isSdocRevision,H=j.isPublished,V=j.originFilename,B=j.revisionCreatedAt,Q=j.originFileVersion,W=j.originFilePath,q=j.originDocUuid,z=j.revisionId;window.seafile={repoID:x,docPath:C,docName:E,docUuid:_,isOpenSocket:!0,serviceUrl:w,accessToken:K,sdocServer:O,name:N,username:T,avatarURL:L,siteRoot:U,docPerm:y,historyURL:s.c.generateHistoryURL(U,x,C),parentFolderURL:"".concat(U,"library/").concat(x,"/").concat(s.c.encodePath(A+F)),assetsUrl:M,isShowInternalLink:!0,isStarIconShown:!0,isSdocRevision:G,isPublished:H,originFilename:V,originFileVersion:Q,originFilePath:W,originDocUuid:q,revisionCreatedAt:B,lang:P,revisionId:z,mediaUrl:R},i.render((0,D.jsx)(a.a3,{i18n:o.Z,children:(0,D.jsx)(t.Suspense,{fallback:(0,D.jsx)(c.Z,{}),children:(0,D.jsx)(b,{})})}),document.getElementById("wrapper"))}},function(e){e.O(0,[351],(function(){return r=53854,e(e.s=r);var r}));e.O()}]);
//# sourceMappingURL=viewFileSdoc.721fab36.js.map