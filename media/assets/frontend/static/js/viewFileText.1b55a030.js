"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[425],{66488:function(t,n,e){var i=e(97326),a=e(15671),s=e(43144),r=e(60136),c=e(29388),o=e(72791),u=e(54164),p=e(51832),d=e(53585),h=e(88585),f=e(42383),v=e(13523),l=e(22228),S=(e(77937),e(80184)),g=window.app.pageOptions,P=g.err,C=g.fileExt,Z=g.fileContent,x=g.repoID,k=g.filePath,m=g.fileName,y=g.canEditFile,w=g.username,j=function(t){(0,r.Z)(e,t);var n=(0,c.Z)(e);function e(){return(0,a.Z)(this,e),n.apply(this,arguments)}return(0,s.Z)(e,[{key:"render",value:function(){return P?(0,S.jsx)(v.Z,{}):(0,S.jsx)("div",{className:"file-view-content flex-1 text-file-view",children:(0,S.jsx)(f.Z,{fileExt:C,value:this.props.content,readOnly:!y,onChange:this.props.updateContent})})}}]),e}(o.Component),I=function(t){(0,r.Z)(e,t);var n=(0,c.Z)(e);function e(t){var s;return(0,a.Z)(this,e),(s=n.call(this,t)).updateContent=function(t){s.setState({needSave:!0,content:t})},s.addParticipant=function(){l.I.addFileParticipants(x,k,[w]).then((function(t){200===t.status&&(s.isParticipant=!0,s.getParticipants())}))},s.getParticipants=function(){l.I.listFileParticipants(x,k).then((function(t){var n=t.data.participant_list;s.setState({participants:n}),n.length>0&&(s.isParticipant=n.every((function(t){return t.email==w})))}))},s.onParticipantsChange=function(){s.getParticipants()},s.state={content:Z,needSave:!1,isSaving:!1,participants:[]},s.onSave=s.onSave.bind((0,i.Z)(s)),s.isParticipant=!1,s}return(0,s.Z)(e,[{key:"onSave",value:function(){var t=this;this.isParticipant||this.addParticipant();return l.I.getUpdateLink(x,"/").then((function(n){var e=n.data;return t.setState({isSaving:!0}),l.I.updateFile(e,k,m,t.state.content).then((function(){p.Z.success((0,d.ih)("Successfully saved"),{duration:2}),t.setState({isSaving:!1,needSave:!1})}))}))}},{key:"componentDidMount",value:function(){this.getParticipants()}},{key:"render",value:function(){return(0,S.jsx)(h.Z,{content:(0,S.jsx)(j,{content:this.state.content,updateContent:this.updateContent}),isSaving:this.state.isSaving,needSave:this.state.needSave,onSave:this.onSave,participants:this.state.participants,onParticipantsChange:this.onParticipantsChange})}}]),e}(o.Component);u.render((0,S.jsx)(I,{}),document.getElementById("wrapper"))}},function(t){t.O(0,[351],(function(){return n=66488,t(t.s=n);var n}));t.O()}]);
//# sourceMappingURL=viewFileText.1b55a030.js.map